<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>inversion_sst_gp.plot_helper &#8212; SST currents 2025 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=cb975c41"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for inversion_sst_gp.plot_helper</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Plot helper module.</span>

<span class="sd">This module contains utilities for creating visualizations, including functions for</span>
<span class="sd">plotting images, color mapping, and drawing shapes.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.transforms</span><span class="w"> </span><span class="kn">import</span> <span class="n">Affine2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ellipse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScalarMappable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">sub</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cmocean</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">colorcet</span>

<div class="viewcode-block" id="imshow">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.imshow">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays an image with modified extent based on the grid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to plot on.</span>
<span class="sd">    X : ndarray</span>
<span class="sd">        Grid of x-coordinates.</span>
<span class="sd">    Y : ndarray</span>
<span class="sd">        Grid of y-coordinates.</span>
<span class="sd">    Z : ndarray</span>
<span class="sd">        Data to display as an image.</span>
<span class="sd">    *args : tuple</span>
<span class="sd">        Additional arguments for `imshow`.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for `imshow`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matplotlib.image.AxesImage</span>
<span class="sd">        The image object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># modified imshow</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>


        <span class="n">dx</span>     <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">dy</span>     <span class="o">=</span> <span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dy</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">dx</span>     <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">dy</span>     <span class="o">=</span> <span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">dy</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="mask">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.mask">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays a mask overlay on a plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to plot on.</span>
<span class="sd">    X : ndarray</span>
<span class="sd">        Grid of x-coordinates.</span>
<span class="sd">    Y : ndarray</span>
<span class="sd">        Grid of y-coordinates.</span>
<span class="sd">    mask : ndarray</span>
<span class="sd">        Boolean mask array.</span>
<span class="sd">    color : str</span>
<span class="sd">        Color for the mask overlay.</span>
<span class="sd">    *args : tuple</span>
<span class="sd">        Additional arguments for `imshow`.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for `imshow`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matplotlib.image.AxesImage</span>
<span class="sd">        The mask overlay image object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">maskn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


    <span class="n">maskn</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="n">color</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">maskn</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="quiver">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.quiver">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">an</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a quiver plot with optional annotation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to plot on.</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        Grid of x-coordinates.</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        Grid of y-coordinates.</span>
<span class="sd">    u : ndarray</span>
<span class="sd">        Velocity field in the x-direction.</span>
<span class="sd">    v : ndarray</span>
<span class="sd">        Velocity field in the y-direction.</span>
<span class="sd">    scale : float, optional</span>
<span class="sd">        Scale factor for the quiver plot. Default is 1.</span>
<span class="sd">    unit : float, optional</span>
<span class="sd">        Unit vector length for annotation. Default is 1.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        Label for the annotation. Default is an empty string.</span>
<span class="sd">    xlims : tuple, optional</span>
<span class="sd">        x-axis limits. Default is None.</span>
<span class="sd">    ylims : tuple, optional</span>
<span class="sd">        y-axis limits. Default is None.</span>
<span class="sd">    nx : int, optional</span>
<span class="sd">        Number of vectors in the x-direction. Default is None.</span>
<span class="sd">    ny : int, optional</span>
<span class="sd">        Number of vectors in the y-direction. Default is None.</span>
<span class="sd">    an : bool, optional</span>
<span class="sd">        Whether to add annotation. Default is True.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for `quiver`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matplotlib.quiver.Quiver</span>
<span class="sd">        The quiver plot object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    
    <span class="c1"># quiver with annotation</span>
    <span class="k">if</span> <span class="n">nx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">ix</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">nx</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">ny</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">ny</span><span class="p">))</span>

    <span class="n">vec</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[::</span><span class="n">iy</span><span class="p">,::</span><span class="n">ix</span><span class="p">],</span><span class="n">y</span><span class="p">[::</span><span class="n">iy</span><span class="p">,::</span><span class="n">ix</span><span class="p">],</span><span class="n">u</span><span class="p">[::</span><span class="n">iy</span><span class="p">,::</span><span class="n">ix</span><span class="p">],</span><span class="n">v</span><span class="p">[::</span><span class="n">iy</span><span class="p">,::</span><span class="n">ix</span><span class="p">],</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;width&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xlims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ylims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">an</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="n">unit</span><span class="o">/</span><span class="n">scale</span><span class="p">,</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="mf">0.03</span><span class="p">,</span><span class="n">unit</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;width&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">unit</span><span class="o">/</span><span class="n">scale</span><span class="p">,</span><span class="mf">1.03</span><span class="p">),</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vec</span></div>


<div class="viewcode-block" id="draw_confidence_ellipse_single">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.draw_confidence_ellipse_single">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_confidence_ellipse_single</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">n_std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws a single confidence ellipse on a plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to plot on.</span>
<span class="sd">    x : float</span>
<span class="sd">        x-coordinate of the ellipse center.</span>
<span class="sd">    y : float</span>
<span class="sd">        y-coordinate of the ellipse center.</span>
<span class="sd">    cov : ndarray</span>
<span class="sd">        Covariance matrix for the ellipse.</span>
<span class="sd">    n_std : float, optional</span>
<span class="sd">        Number of standard deviations for the ellipse. Default is 1.</span>
<span class="sd">    scale : float, optional</span>
<span class="sd">        Scale factor for the ellipse. Default is 1.</span>
<span class="sd">    xlims : tuple, optional</span>
<span class="sd">        x-axis limits. Default is None.</span>
<span class="sd">    ylims : tuple, optional</span>
<span class="sd">        y-axis limits. Default is None.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for `Ellipse`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matplotlib.axes.Axes</span>
<span class="sd">        The axes with the confidence ellipse added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># plot a single confidence ellipse</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">xlims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ylims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">pearson</span> <span class="o">=</span> <span class="n">cov</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">cov</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ell_radius_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pearson</span><span class="p">)</span>
    <span class="n">ell_radius_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pearson</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="n">ell_radius_x</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">ell_radius_y</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1"># draw sample ellipse</span>
    <span class="n">scale_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">n_std</span> <span class="c1"># standard deviation of x</span>
    <span class="n">scale_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">n_std</span> <span class="c1"># standard deviation of y</span>
    <span class="n">mean_x</span>  <span class="o">=</span> <span class="n">x</span>
    <span class="n">mean_y</span>  <span class="o">=</span> <span class="n">y</span>

    <span class="c1"># transform object</span>
    <span class="n">transf</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span> \
                <span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span> \
                <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale_x</span><span class="o">/</span><span class="n">scale</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="n">scale_y</span><span class="o">/</span><span class="n">scale</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="n">get_aspect</span><span class="p">(</span><span class="n">ax</span><span class="p">))</span> \
                <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">mean_x</span><span class="p">,</span> <span class="n">mean_y</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transf</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="anno_confidence_ellipse">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.anno_confidence_ellipse">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">anno_confidence_ellipse</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds annotation to a plot of confidence ellipses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to annotate.</span>
<span class="sd">    scale : float, optional</span>
<span class="sd">        Scale factor for the annotation. Default is 1.</span>
<span class="sd">    unit : float, optional</span>
<span class="sd">        Unit length for the annotation. Default is 1.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        Label for the annotation. Default is an empty string.</span>
<span class="sd">    xlims : tuple, optional</span>
<span class="sd">        x-axis limits. Default is None.</span>
<span class="sd">    ylims : tuple, optional</span>
<span class="sd">        y-axis limits. Default is None.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for the annotation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># add annotation to plot of confidence ellipse(s)</span>
    <span class="k">if</span> <span class="n">xlims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">xlims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ylims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>            
    <span class="n">dx</span> <span class="o">=</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span> <span class="o">=</span> <span class="s1">&#39;|-|,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span>
                    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">),</span>
                <span class="n">xycoords</span> <span class="o">=</span> <span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span>
                <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">unit</span><span class="o">/</span><span class="n">dx</span><span class="o">/</span><span class="n">scale</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">),</span>
                <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span>
                <span class="n">arrowprops</span> <span class="o">=</span> <span class="n">arrowprops</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">,</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">unit</span><span class="o">/</span><span class="n">dx</span><span class="o">/</span><span class="n">scale</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">),</span>
                <span class="n">xycoords</span> <span class="o">=</span> <span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span>
                <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="draw_confidence_ellipse">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.draw_confidence_ellipse">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_confidence_ellipse</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c_cov</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">an</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots confidence ellipses on a grid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to plot on.</span>
<span class="sd">    x : ndarray</span>
<span class="sd">        Grid of x-coordinates.</span>
<span class="sd">    y : ndarray</span>
<span class="sd">        Grid of y-coordinates.</span>
<span class="sd">    c_cov : ndarray</span>
<span class="sd">        Covariance matrices for the ellipses.</span>
<span class="sd">    nx : int, optional</span>
<span class="sd">        Number of ellipses in the x-direction. Default is None.</span>
<span class="sd">    ny : int, optional</span>
<span class="sd">        Number of ellipses in the y-direction. Default is None.</span>
<span class="sd">    n_std : float, optional</span>
<span class="sd">        Number of standard deviations for the ellipses. Default is 1.</span>
<span class="sd">    scale : float, optional</span>
<span class="sd">        Scale factor for the ellipses. Default is 1.</span>
<span class="sd">    unit : float, optional</span>
<span class="sd">        Unit length for the annotation. Default is 1.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        Label for the annotation. Default is an empty string.</span>
<span class="sd">    xlims : tuple, optional</span>
<span class="sd">        x-axis limits. Default is None.</span>
<span class="sd">    ylims : tuple, optional</span>
<span class="sd">        y-axis limits. Default is None.</span>
<span class="sd">    an : bool, optional</span>
<span class="sd">        Whether to add annotation. Default is True.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for the ellipses.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matplotlib.axes.Axes</span>
<span class="sd">        The axes with the confidence ellipses added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># plot confidence ellipses</span>
    <span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>


    <span class="k">if</span> <span class="n">nx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Nx</span><span class="o">/</span><span class="n">nx</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">ny</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Ny</span><span class="o">/</span><span class="n">ny</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Nx</span><span class="p">,</span><span class="n">ix</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Ny</span><span class="p">,</span><span class="n">iy</span><span class="p">):</span>
            <span class="n">draw_confidence_ellipse_single</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">c_cov</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,:,:],</span><span class="n">n_std</span><span class="o">=</span><span class="n">n_std</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span><span class="n">ylims</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">an</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">anno_confidence_ellipse</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span><span class="n">ylims</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="get_aspect">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.get_aspect">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_aspect</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the aspect ratio of the data in the axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to calculate the aspect ratio for.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        The aspect ratio of the data in the axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># get the aspect ratio of the figure</span>
    <span class="n">figW</span><span class="p">,</span> <span class="n">figH</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span> <span class="c1"># total figure size</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">bounds</span> <span class="c1"># axis size on figure</span>
    <span class="n">disp_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">figH</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">figW</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span> <span class="c1"># ratio of display units</span>
    <span class="n">data_ratio</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span> <span class="o">/</span> <span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span> <span class="c1"># ratio of data units</span>
    <span class="k">return</span> <span class="n">disp_ratio</span> <span class="o">/</span> <span class="n">data_ratio</span></div>


<div class="viewcode-block" id="ticks_from_spacing">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.ticks_from_spacing">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ticks_from_spacing</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span> <span class="n">tickspacing</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates tick positions based on a specified spacing and data range.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lims : tuple</span>
<span class="sd">        The lower and upper limits of the data range.</span>
<span class="sd">    tickspacing : float</span>
<span class="sd">        The spacing between ticks.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        A tuple containing the tick positions and the order of magnitude of the tick spacing.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># generate ticks based on a specified tick spacing and the data range</span>

    <span class="c1"># calculate the order of magnitude of the tick spacing</span>
    <span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">tickspacing</span><span class="p">))))</span>

    <span class="c1"># calculate the lower and upper limits for tick generation</span>
    <span class="n">lower_limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">lims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">order</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">upper_limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">lims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">order</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># generate all possible ticks</span>
    <span class="n">ticks_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span> <span class="o">+</span> <span class="n">tickspacing</span><span class="p">,</span> <span class="n">tickspacing</span><span class="p">)</span>

    <span class="c1"># filter out ticks that fall outside the data range</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">ticks_all</span><span class="p">[(</span><span class="n">ticks_all</span> <span class="o">&gt;=</span> <span class="n">lims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ticks_all</span> <span class="o">&lt;=</span> <span class="n">lims</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

    <span class="k">return</span> <span class="n">ticks</span><span class="p">,</span> <span class="n">order</span></div>


<div class="viewcode-block" id="ticks_in_deg">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.ticks_in_deg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ticks_in_deg</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xtickspacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ytickspacing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts tick labels into geographic coordinates (degrees).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to modify tick labels for.</span>
<span class="sd">    xtickspacing : float, optional</span>
<span class="sd">        Spacing for x-axis ticks. Default is None.</span>
<span class="sd">    ytickspacing : float, optional</span>
<span class="sd">        Spacing for y-axis ticks. Default is None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># change tick labels into geographic coordinates.</span>
    <span class="k">if</span> <span class="n">xtickspacing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">xlims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">xticks</span><span class="p">,</span> <span class="n">xorder</span> <span class="o">=</span> <span class="n">ticks_from_spacing</span><span class="p">(</span><span class="n">xlims</span><span class="p">,</span> <span class="n">xtickspacing</span><span class="p">)</span>
        <span class="n">Nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
            <span class="n">xtick</span> <span class="o">=</span> <span class="n">xticks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">xtick</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">xorder</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">xticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xtick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$E&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;{:.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">xorder</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;f}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xtick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$E&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">xorder</span> <span class="o">&gt;-</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">xticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="n">xtick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$W&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;{:.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">xorder</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;f}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="n">xtick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$W&#39;</span><span class="p">)</span>
                
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ytickspacing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">yticks</span><span class="p">,</span> <span class="n">yorder</span> <span class="o">=</span> <span class="n">ticks_from_spacing</span><span class="p">(</span><span class="n">ylims</span><span class="p">,</span> <span class="n">ytickspacing</span><span class="p">)</span>
        <span class="n">Ny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
        <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="n">ytick</span> <span class="o">=</span> <span class="n">yticks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ytick</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">yorder</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">yticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ytick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$N&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">yticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;{:.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">yorder</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;f}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ytick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$N&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">yorder</span> <span class="o">&gt;-</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">yticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="n">ytick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$S&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">yticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;{:.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">yorder</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;f}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="n">ytick</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$^\circ$S&#39;</span><span class="p">)</span>
                
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">yticklabels</span><span class="p">)</span></div>


<div class="viewcode-block" id="add_colorbar_map">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.add_colorbar_map">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">add_colorbar_map</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">cax</span><span class="p">,</span> <span class="n">lims</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">format_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a colorbar to a map plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">        The figure to add the colorbar to.</span>
<span class="sd">    cax : matplotlib.axes.Axes</span>
<span class="sd">        The axes for the colorbar.</span>
<span class="sd">    lims : tuple</span>
<span class="sd">        The value limits for the colorbar (vmin, vmax).</span>
<span class="sd">    cmap : matplotlib.colors.Colormap</span>
<span class="sd">        The colormap for the colorbar.</span>
<span class="sd">    side : str</span>
<span class="sd">        The side of the plot to place the colorbar (&#39;left&#39;, &#39;right&#39;, &#39;top&#39;, &#39;bottom&#39;).</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        The label for the colorbar. Default is None.</span>
<span class="sd">    format_label : bool, optional</span>
<span class="sd">        Whether to format the label. Default is False.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for `colorbar`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
        <span class="c1"># add colormap to axis</span>

    <span class="c1"># value limits</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">lims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">lims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

    <span class="c1"># placing and tick locations</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
        <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_offset_position</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
            <span class="n">cax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_offset_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>   
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">format_label</span><span class="p">:</span>
                <span class="n">add_ax_ylabel_format</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span><span class="n">label</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
        <span class="n">cax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">format_label</span><span class="p">:</span>
                <span class="n">add_ax_xlabel_format</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span><span class="n">label</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="add_colorbar">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.add_colorbar">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">lims</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">cbr</span><span class="p">,</span> <span class="n">cbd</span><span class="p">,</span> <span class="n">cbw</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">format_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a colorbar to a plot with specified dimensions and placement.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">        The figure to add the colorbar to.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to associate the colorbar with.</span>
<span class="sd">    side : str</span>
<span class="sd">        The side of the plot to place the colorbar (&#39;top&#39;, &#39;bottom&#39;, &#39;left&#39;, &#39;right&#39;).</span>
<span class="sd">    lims : tuple</span>
<span class="sd">        The value limits for the colorbar (vmin, vmax).</span>
<span class="sd">    cmap : matplotlib.colors.Colormap</span>
<span class="sd">        The colormap for the colorbar.</span>
<span class="sd">    cbr : float</span>
<span class="sd">        The relative width of the colorbar.</span>
<span class="sd">    cbd : float</span>
<span class="sd">        The distance of the colorbar from the plot.</span>
<span class="sd">    cbw : float</span>
<span class="sd">        The width of the colorbar.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        The label for the colorbar. Default is None.</span>
<span class="sd">    format_label : bool, optional</span>
<span class="sd">        Whether to format the label. Default is False.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for `colorbar`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># add colorbar</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="c1"># get the position of the axes</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">pw</span><span class="p">,</span> <span class="n">ph</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">height</span> <span class="c1"># extract the location, width, and height</span>
    <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x0</span><span class="o">+</span><span class="n">pw</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cbr</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">ph</span><span class="o">+</span><span class="n">cbd</span><span class="p">,</span> <span class="n">cbr</span><span class="o">*</span><span class="n">pw</span><span class="p">,</span> <span class="n">cbw</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span><span class="p">:</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x0</span><span class="o">+</span><span class="n">pw</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cbr</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y0</span><span class="o">-</span><span class="n">cbd</span><span class="o">-</span><span class="n">cbw</span><span class="p">,</span> <span class="n">cbr</span><span class="o">*</span><span class="n">pw</span><span class="p">,</span> <span class="n">cbw</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="n">cbd</span><span class="o">-</span><span class="n">cbw</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">ph</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cbr</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">cbw</span><span class="p">,</span> <span class="n">cbr</span><span class="o">*</span><span class="n">ph</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">side</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x0</span><span class="o">+</span><span class="n">pw</span><span class="o">+</span><span class="n">cbd</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">ph</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cbr</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">cbw</span><span class="p">,</span> <span class="n">cbr</span><span class="o">*</span><span class="n">ph</span><span class="p">])</span>
    <span class="n">add_colorbar_map</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">cax</span><span class="p">,</span><span class="n">lims</span><span class="p">,</span><span class="n">cmap</span><span class="p">,</span><span class="n">side</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">format_label</span><span class="o">=</span><span class="n">format_label</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">pass</span></div>



<div class="viewcode-block" id="add_ax_ylabel_format">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.add_ax_ylabel_format">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">add_ax_ylabel_format</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a formatted y-axis label to the axes, including offset text if present.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">        The figure containing the axes.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to modify.</span>
<span class="sd">    label : str</span>
<span class="sd">        The label text for the y-axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>


    <span class="n">offset_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_offset_text</span><span class="p">()</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">offset_text</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">offset_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="add_ax_xlabel_format">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.add_ax_xlabel_format">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">add_ax_xlabel_format</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a formatted x-axis label to the axes, including offset text if present.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">        The figure containing the axes.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to modify.</span>
<span class="sd">    label : str</span>
<span class="sd">        The label text for the x-axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>


    <span class="n">offset_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_offset_text</span><span class="p">()</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">offset_text</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">offsetText</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">offset_text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></div>


<span class="c1"># def annotate_corner(ax, text, x=.026, y=.974):</span>
<span class="c1">#     # annotate corner of plot</span>
    
<span class="c1">#     ax.annotate(text, </span>
<span class="c1">#                 xy=(x,y),</span>
<span class="c1">#                 va=&#39;top&#39;,ha=&#39;left&#39;, </span>
<span class="c1">#                 xycoords=&#39;axes fraction&#39;,</span>
<span class="c1">#                 bbox=dict(facecolor=&#39;white&#39;,edgecolor=&#39;black&#39;,pad=3.5,linewidth=1), </span>
<span class="c1">#                 clip_box=ax.bbox,</span>
<span class="c1">#                 zorder=10)</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="annotate_corner">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.annotate_corner">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">annotate_corner</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Annotates the corner of a plot with a text label, optionally adding a box.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes to annotate.</span>
<span class="sd">    text : str</span>
<span class="sd">        The text to display in the corner.</span>
<span class="sd">    fontsize : int, optional</span>
<span class="sd">        Font size for the text. Default is 12.</span>
<span class="sd">    fig : matplotlib.figure.Figure, optional</span>
<span class="sd">        The figure containing the axes. Default is the current figure.</span>
<span class="sd">    box : bool, optional</span>
<span class="sd">        Whether to add a box around the text. Default is True.</span>
<span class="sd">    buffer : int, optional</span>
<span class="sd">        Additional spacing around the text. Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
    <span class="n">axis_height_inches</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
    <span class="n">axis_height_points</span> <span class="o">=</span> <span class="n">axis_height_inches</span> <span class="o">*</span> <span class="mi">72</span>  <span class="c1"># Convert inches to points</span>
    <span class="n">axis_width_inches</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span>
    <span class="n">axis_width_points</span> <span class="o">=</span> <span class="n">axis_width_inches</span> <span class="o">*</span> <span class="mi">72</span>  <span class="c1"># Convert inches to points</span>

    <span class="n">aspect</span> <span class="o">=</span> <span class="mf">0.6</span>
    <span class="n">me</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">fontsize</span><span class="o">/</span><span class="mi">12</span><span class="o">+</span><span class="n">buffer</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">fontsize</span><span class="o">/</span><span class="mi">12</span><span class="o">+</span><span class="n">buffer</span>
    <span class="n">mn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">fontsize</span><span class="o">/</span><span class="mi">12</span><span class="o">+</span><span class="n">buffer</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">fontsize</span><span class="o">/</span><span class="mi">12</span><span class="o">+</span><span class="n">buffer</span>

    <span class="n">box_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">fontsize</span><span class="o">+</span><span class="n">mn</span><span class="o">+</span><span class="n">ms</span><span class="p">)</span><span class="o">/</span><span class="n">axis_height_points</span>
    <span class="n">box_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">fontsize</span><span class="o">*</span><span class="n">aspect</span><span class="o">+</span><span class="n">me</span><span class="o">+</span><span class="n">mw</span><span class="p">)</span><span class="o">/</span><span class="n">axis_width_points</span>


    <span class="k">if</span> <span class="n">box</span><span class="p">:</span>
        <span class="c1"># Add a square in the top right corner of the axis</span>
        <span class="n">corner_square</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">box_h</span><span class="p">),</span>  <span class="c1"># (x, y) position of bottom left corner in axis fraction</span>
            <span class="n">box_w</span><span class="p">,</span>        <span class="c1"># width of the square in axis fraction</span>
            <span class="n">box_h</span><span class="p">,</span>        <span class="c1"># height of the square in axis fraction</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>  <span class="c1"># Use axis coordinates for positioning</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>           <span class="c1"># Color of the square</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>                <span class="c1"># Transparency</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">corner_square</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">/</span><span class="n">axis_width_points</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">mn</span><span class="o">+</span><span class="n">fontsize</span><span class="p">)</span><span class="o">/</span><span class="n">axis_height_points</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></div>


<div class="viewcode-block" id="visualize_data">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.visualize_data">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">visualize_data</span><span class="p">(</span><span class="n">LON</span><span class="p">,</span> <span class="n">LAT</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dTdt</span><span class="p">,</span> <span class="n">dTds1</span><span class="p">,</span> <span class="n">dTds2</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lonlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimTgrad</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">plimdTdt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimspeed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pscale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label_obs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>    


    <span class="n">bool_velocity</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>


    
    <span class="n">mn</span> <span class="o">=</span> <span class="mf">.3</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="mf">.2</span>
    <span class="n">me</span> <span class="o">=</span> <span class="mf">.03</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="mf">.18</span>
    <span class="n">md</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">Nx</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">bool_velocity</span>
    <span class="n">Ny</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">aspect</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">lx</span> <span class="o">=</span> <span class="n">me</span><span class="o">+</span><span class="n">mw</span><span class="o">+</span><span class="n">md</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">Nx</span><span class="o">*</span><span class="n">aspect</span>
    <span class="n">ly</span> <span class="o">=</span> <span class="n">mn</span><span class="o">+</span><span class="n">ms</span><span class="o">+</span><span class="n">Ny</span>

    <span class="n">ph</span> <span class="o">=</span> <span class="n">aspect</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">cbd</span> <span class="o">=</span> <span class="mf">.01</span> <span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">cbr</span> <span class="o">=</span> <span class="mf">.85</span>
    <span class="n">cbw</span> <span class="o">=</span> <span class="mf">.015</span> <span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>

    <span class="n">px_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">mw</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Nx</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">md</span><span class="p">))</span><span class="o">/</span><span class="n">lx</span>
    <span class="n">py_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">ly</span><span class="o">-</span><span class="n">mn</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Ny</span><span class="p">))</span><span class="o">/</span><span class="n">ly</span>

    <span class="n">fw</span> <span class="o">=</span> <span class="n">Nx</span><span class="o">*</span><span class="mf">2.5</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">fw</span><span class="o">*</span><span class="n">ly</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">],</span><span class="nb">object</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fw</span><span class="p">,</span><span class="n">fh</span><span class="p">))</span>

    <span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">px_range</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">py_range</span><span class="p">[</span><span class="n">jj</span><span class="p">],</span> <span class="n">pw</span><span class="p">,</span> <span class="n">ph</span><span class="p">])</span>  <span class="c1"># [left, bottom, width, height]</span>
            <span class="k">if</span> <span class="n">lonlims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">lonlims</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">latlims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">latlims</span><span class="p">)</span>

    <span class="n">cmapT</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">thermal</span>
    <span class="n">cmapdTdt</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">haline</span>
    <span class="n">cmapTgrad</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">amp</span>


    <span class="k">if</span> <span class="n">plimT</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plimT</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">T</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span>
        
    <span class="k">if</span> <span class="n">plimTgrad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dTds1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">dTds2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
        <span class="n">plimvalTgrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">listvar</span><span class="p">)</span>
        <span class="n">plimTgrad</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">plimvalTgrad</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">plimdTdt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">=</span> <span class="p">[</span><span class="n">dTdt</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
        <span class="n">plimvaldTdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">listvar</span><span class="p">)</span>
        <span class="n">plimdTdt</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">plimvaldTdt</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">plimvaldTdt</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">label_obs</span><span class="p">:</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimT</span><span class="p">,</span><span class="n">cmapT</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{T}</span><span class="s1">^o$ ($^\circ$C)&#39;</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimTgrad</span><span class="p">,</span><span class="n">cmapTgrad</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nabla \mathbf</span><span class="si">{T}</span><span class="s1">^o$ (K$\,$m$^{-1}$)&#39;</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimdTdt</span><span class="p">,</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$d\mathbf</span><span class="si">{T}</span><span class="s2">^o/dt$ (K$\,$s$^{-1}$)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimT</span><span class="p">,</span><span class="n">cmapT</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{T}</span><span class="s1">$ ($^\circ$C)&#39;</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimTgrad</span><span class="p">,</span><span class="n">cmapTgrad</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nabla \mathbf</span><span class="si">{T}</span><span class="s1">$ (K$\,$m$^{-1}$)&#39;</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimdTdt</span><span class="p">,</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$d\mathbf</span><span class="si">{T}</span><span class="s2">/dt$ (K$\,$s$^{-1}$)&quot;</span><span class="p">)</span>
         
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapT</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimT</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimT</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dTds1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">dTds2</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapTgrad</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimTgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">dTdt</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">mask</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dTdt</span><span class="p">),</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">mask</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">T</span><span class="p">),</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">bool_velocity</span><span class="p">:</span>
        <span class="n">cmapspeed</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">lighten</span><span class="p">(</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span><span class="mf">.6</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plimspeed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">listvar</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
            <span class="n">plimvalspeed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">listvar</span><span class="p">)</span>
            <span class="n">plimspeed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">plimvalspeed</span><span class="p">)]</span>           
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimspeed</span><span class="p">,</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$(\mathbf</span><span class="si">{u}</span><span class="s2">&#39;,\mathbf</span><span class="si">{v}</span><span class="s2">&#39;)&#39;$ (m$\,$s$^{-1}$)&quot;</span><span class="p">)</span>
    
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        
        <span class="n">ldx</span> <span class="o">=</span> <span class="mf">.01</span>
        <span class="n">ldy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.03</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
        <span class="n">lh</span> <span class="o">=</span> <span class="mf">.015</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mf">.005</span>

        <span class="n">mw</span> <span class="o">=</span> <span class="n">px_range</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">py_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;Velocity&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;&lt;|-,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">))</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">axi</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="n">ticks_in_deg</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">jticks</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">iticks</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">iticks</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span> <span class="o">!=</span> <span class="n">jticks</span><span class="p">):</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    
    <span class="n">ax0</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">return</span></div>

    
<div class="viewcode-block" id="plot_predictions_osse">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_predictions_osse">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_predictions_osse</span><span class="p">(</span><span class="n">LON</span><span class="p">,</span> <span class="n">LAT</span><span class="p">,</span> <span class="n">To</span><span class="p">,</span> <span class="n">dTds1o</span><span class="p">,</span> <span class="n">dTds2o</span><span class="p">,</span> <span class="n">dTdto</span><span class="p">,</span> <span class="n">muSstar</span><span class="p">,</span> <span class="n">Kxstar_vel</span><span class="p">,</span> <span class="n">stdSstar</span><span class="p">,</span> <span class="n">muustar</span><span class="p">,</span> <span class="n">muvstar</span><span class="p">,</span> <span class="n">lonlims</span><span class="p">,</span> <span class="n">latlims</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">LONr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">LATr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ugos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vgos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Sgos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">datet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimdTdt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimTgrad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimstdS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plimspeed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pscale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">pscale_cred</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nxr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nyr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>    



    <span class="c1"># plot overview of satellite products and predictions</span>


    <span class="k">if</span> <span class="n">pscale_cred</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">pscale_cred</span> <span class="o">=</span> <span class="n">pscale</span>
    
    <span class="n">bool_original_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">S</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">bool_reference_velocity</span> <span class="o">=</span> <span class="p">(</span><span class="n">LONr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">LATr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ur</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">vr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">bool_GOS</span> <span class="o">=</span> <span class="p">(</span><span class="n">ugos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">vgos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Sgos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="n">mn</span> <span class="o">=</span> <span class="mf">.4</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="mf">.15</span>
    <span class="n">me</span> <span class="o">=</span> <span class="mf">.25</span>
    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="mf">.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="mf">.4</span>
    <span class="n">md</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">td</span> <span class="o">=</span> <span class="mf">0.005</span>

    <span class="n">Nx</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">Ny</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">bool_GOS</span> <span class="o">-</span> <span class="n">bool_reference_velocity</span>

    <span class="n">aspect</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">lx</span> <span class="o">=</span> <span class="n">me</span><span class="o">+</span><span class="n">mw</span><span class="o">+</span><span class="n">Nx</span><span class="o">*</span><span class="n">aspect</span>
    <span class="n">ly</span> <span class="o">=</span> <span class="n">mn</span><span class="o">+</span><span class="n">ms</span><span class="o">+</span><span class="n">md</span><span class="o">*</span><span class="p">(</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">Ny</span>

    <span class="n">ph</span> <span class="o">=</span> <span class="n">aspect</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">cbd</span> <span class="o">=</span> <span class="mf">.01</span> <span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">cbr</span> <span class="o">=</span> <span class="mf">.85</span>
    <span class="n">cbw</span> <span class="o">=</span> <span class="mf">.02</span> <span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>

    <span class="n">px_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">mw</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Nx</span><span class="p">))</span><span class="o">/</span><span class="n">lx</span>
    <span class="n">py_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">ly</span><span class="o">-</span><span class="n">mn</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Ny</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">md</span><span class="p">))</span><span class="o">/</span><span class="n">ly</span>

    <span class="n">fw</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">fw</span><span class="o">*</span><span class="n">ly</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">],</span><span class="nb">object</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fw</span><span class="p">,</span><span class="n">fh</span><span class="p">))</span>

    <span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">px_range</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">py_range</span><span class="p">[</span><span class="n">jj</span><span class="p">],</span> <span class="n">pw</span><span class="p">,</span> <span class="n">ph</span><span class="p">])</span>  <span class="c1"># [left, bottom, width, height]</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">lonlims</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">latlims</span><span class="p">)</span>

    <span class="n">cmapstdS</span> <span class="o">=</span> <span class="n">colorcet</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gouldian</span>
    <span class="n">cmapTgrad</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">amp</span>
    <span class="n">cmapT</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">thermal</span>
    <span class="n">cmapdTdt</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">haline</span>
    <span class="n">cmapspeed</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">lighten</span><span class="p">(</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span><span class="mf">.6</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">set_lims</span><span class="p">(</span><span class="n">plim</span><span class="p">,</span><span class="n">datalim</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">plim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datalim</span><span class="p">,</span> <span class="s1">&#39;neither&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extend_min</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">extend_max</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">plim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">datalim</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">plim</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">plim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">datalim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">extend_min</span><span class="o">=</span><span class="kc">True</span>
                    
            <span class="k">if</span> <span class="n">plim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datalim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">plim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">datalim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">extend_max</span><span class="o">=</span><span class="kc">True</span>
                    
            <span class="k">if</span> <span class="n">extend_min</span> <span class="ow">and</span> <span class="n">extend_max</span><span class="p">:</span>
                <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span>
            <span class="k">elif</span> <span class="n">extend_min</span><span class="p">:</span>
                <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
            <span class="k">elif</span> <span class="n">extend_max</span><span class="p">:</span>
                <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;neither&#39;</span>
            <span class="k">return</span> <span class="n">lim</span><span class="p">,</span> <span class="n">extend</span> 

    <span class="n">datalimT</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">To</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">To</span><span class="p">)]</span>
    <span class="n">plimT</span><span class="p">,</span> <span class="n">extendT</span> <span class="o">=</span> <span class="n">set_lims</span><span class="p">(</span><span class="n">plimT</span><span class="p">,</span><span class="n">datalimT</span><span class="p">)</span>

    <span class="n">listvar</span> <span class="o">=</span> <span class="p">[</span><span class="n">muSstar</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">dTdto</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bool_GOS</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Sgos</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bool_original_data</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">+=</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="n">datalimvaldTdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">listvar</span><span class="p">)</span>
    <span class="n">datalimdTdt</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">datalimvaldTdt</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">datalimvaldTdt</span><span class="p">)]</span>
    <span class="n">plimdTdt</span><span class="p">,</span> <span class="n">extenddTdt</span> <span class="o">=</span> <span class="n">set_lims</span><span class="p">(</span><span class="n">plimdTdt</span><span class="p">,</span><span class="n">datalimdTdt</span><span class="p">)</span>

    <span class="n">datalimvalTgrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dTds1o</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">dTds2o</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">datalimTgrad</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">datalimvalTgrad</span><span class="p">)]</span>
    <span class="n">plimTgrad</span><span class="p">,</span> <span class="n">extendTgrad</span> <span class="o">=</span> <span class="n">set_lims</span><span class="p">(</span><span class="n">plimTgrad</span><span class="p">,</span><span class="n">datalimTgrad</span><span class="p">)</span>

    <span class="n">datalimvalstdS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">stdSstar</span><span class="p">])</span>
    <span class="n">datalimstdS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">datalimvalstdS</span><span class="p">))]</span>
    <span class="n">plimstdS</span><span class="p">,</span> <span class="n">extendstdS</span> <span class="o">=</span> <span class="n">set_lims</span><span class="p">(</span><span class="n">plimstdS</span><span class="p">,</span><span class="n">datalimstdS</span><span class="p">)</span>

    <span class="n">listvar</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">muustar</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">muvstar</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bool_GOS</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ugos</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vgos</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bool_original_data</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">listvar</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ur</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>
    <span class="n">datalimvalspeed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">listvar</span><span class="p">)</span>
    <span class="n">datalimspeed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">datalimvalspeed</span><span class="p">)]</span>
    <span class="n">plimspeed</span><span class="p">,</span> <span class="n">extendspeed</span> <span class="o">=</span> <span class="n">set_lims</span><span class="p">(</span><span class="n">plimspeed</span><span class="p">,</span><span class="n">datalimspeed</span><span class="p">)</span>


    <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimTgrad</span><span class="p">,</span><span class="n">cmapTgrad</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(K$\,$m$^{-1}$)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendTgrad</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimT</span><span class="p">,</span><span class="n">cmapT</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;($^\circ$C)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendT</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">plimstdS</span><span class="p">,</span><span class="n">cmapstdS</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(K$\,$s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendstdS</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimspeed</span><span class="p">,</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(m$\,$s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendspeed</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimT</span><span class="p">,</span><span class="n">cmapT</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;($^\circ$C)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendT</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimstdS</span><span class="p">,</span><span class="n">cmapstdS</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(K$\,$s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendstdS</span><span class="p">)</span>
        <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">plimspeed</span><span class="p">,</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(m$\,$s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extendspeed</span><span class="p">)</span>
    <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimdTdt</span><span class="p">,</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;(K$\,$s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extenddTdt</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">To</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapT</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimT</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimT</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dTds1o</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">dTds2o</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapTgrad</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimTgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimTgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">dTdto</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LONr</span><span class="p">,</span><span class="n">LATr</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ur</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vr</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LONr</span><span class="p">,</span><span class="n">LATr</span><span class="p">,</span><span class="n">ur</span><span class="p">,</span><span class="n">vr</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nxr</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">nyr</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">bool_original_data</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">jj</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jj</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">muustar</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">muvstar</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">bool_original_data</span><span class="p">:</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">muustar</span><span class="p">,</span><span class="n">muvstar</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">draw_confidence_ellipse</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">Kxstar_vel</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale_cred</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">muSstar</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">stdSstar</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapstdS</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimstdS</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimstdS</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">bool_original_data</span><span class="p">:</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">px_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">td</span><span class="p">,</span><span class="n">py_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;Observing system simulation experiment&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">px_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">td</span><span class="p">,</span><span class="n">py_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ph</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Satellite products&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">px_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">td</span><span class="p">,</span><span class="n">py_range</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">ph</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;GP prediction&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bool_GOS</span><span class="p">:</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ugos</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vgos</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapspeed</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimspeed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bool_original_data</span><span class="p">:</span>
            <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">ugos</span><span class="p">,</span><span class="n">vgos</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">Sgos</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapdTdt</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimdTdt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">px_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">td</span><span class="p">,</span><span class="n">py_range</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">ph</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;GOS&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>        

    <span class="n">mask</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dTds1o</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">dTds2o</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">mask</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dTdto</span><span class="p">),</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">mask</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">To</span><span class="p">),</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">axi</span><span class="o">.</span><span class="n">has_data</span><span class="p">():</span>
            <span class="n">ticks_in_deg</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
            <span class="n">annotate_corner</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">jticks</span> <span class="o">=</span> <span class="n">Ny</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">bool_GOS</span><span class="p">:</span>
        <span class="n">iticks</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">iticks</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">iticks</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span> <span class="o">!=</span> <span class="n">jticks</span><span class="p">):</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

    <span class="k">if</span> <span class="n">bool_reference_velocity</span><span class="p">:</span>
        <span class="n">mw</span> <span class="o">=</span> <span class="n">px_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">py_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">ldx</span> <span class="o">=</span> <span class="mf">.02</span>
        <span class="n">ldy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.05</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
        <span class="n">lh</span> <span class="o">=</span> <span class="mf">.02</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mf">.005</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 SD Credible Ellipse&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="p">(</span><span class="n">pscale_cred</span><span class="p">)</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;|-|,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale_cred</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">mw</span> <span class="o">=</span> <span class="n">px_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">py_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;Velocity&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;&lt;|-,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">))</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mw</span> <span class="o">=</span> <span class="n">px_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">py_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">ldx</span> <span class="o">=</span> <span class="mf">.02</span>
        <span class="n">ldy</span> <span class="o">=</span> <span class="mf">.02</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
        <span class="n">lh</span> <span class="o">=</span> <span class="mf">.02</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mf">.005</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 SD Credible Ellipse&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="p">(</span><span class="n">pscale</span><span class="p">)</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;|-|,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="p">(</span><span class="n">pscale</span><span class="p">)</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;Velocity&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;&lt;|-,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">))</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">ax0</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">return</span></div>

    
<div class="viewcode-block" id="lon_transect">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.lon_transect">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lon_transect</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">z_mu</span><span class="p">,</span> <span class="n">z_std</span><span class="p">,</span> <span class="n">lonlims</span><span class="p">,</span> <span class="n">xtickspacing</span><span class="p">,</span> <span class="n">z_true</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>            

    <span class="c1"># assign figure</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>

    <span class="c1"># set axis limits </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">lonlims</span><span class="p">)</span>

    <span class="c1"># set tick spacing and labels in degrees</span>
    <span class="n">ticks_in_deg</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">xtickspacing</span><span class="o">=</span><span class="n">xtickspacing</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">z_mu</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mu_u^*$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">z_mu</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">z_std</span><span class="p">,</span><span class="n">z_mu</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">z_std</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="p">[</span><span class="mf">.85</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mf">.85</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 std(u$^*$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">z_mu</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">z_std</span><span class="p">,</span><span class="n">z_mu</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="n">z_std</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="p">[</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mf">.7</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;2 std(u$^*$)&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">z_true</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">z_true</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>

    <span class="c1"># set plot title and axis labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="c1"># set tick positions and parameters for both axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">)</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="plot_transects">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_transects">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_transects</span><span class="p">(</span><span class="n">transect_fully_observed</span><span class="p">,</span> <span class="n">transect_measurement_error</span><span class="p">,</span> <span class="n">transect_dense_cloud</span><span class="p">,</span> <span class="n">transect_sparse_cloud</span><span class="p">,</span> <span class="n">lonlims</span><span class="p">,</span> <span class="n">ylims</span><span class="p">,</span><span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">4.2</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>



    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dic</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">transect_fully_observed</span><span class="p">,</span><span class="n">transect_measurement_error</span><span class="p">,</span><span class="n">transect_dense_cloud</span><span class="p">,</span><span class="n">transect_sparse_cloud</span><span class="p">]):</span>
        <span class="n">axi</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span>
        <span class="n">lon_transect</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;muvstar&#39;</span><span class="p">],</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;stdvstar&#39;</span><span class="p">],</span> <span class="n">lonlims</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z_true</span><span class="o">=</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">],</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">lonlims</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">idx_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;maskc&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">clims</span> <span class="o">=</span> <span class="p">[</span><span class="n">lon</span><span class="p">[</span><span class="n">idx_nan</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="n">lon</span><span class="p">[</span><span class="n">idx_nan</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">clims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">hatch</span> <span class="o">=</span> <span class="s1">&#39;//&#39;</span><span class="p">,</span><span class="n">zorder</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">lw</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;a) Fully observed&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">.03</span><span class="p">,</span> <span class="mf">.96</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;b) Measurement error&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">.03</span><span class="p">,</span> <span class="mf">.96</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;c) Dense cloud&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">.03</span><span class="p">,</span> <span class="mf">.96</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;square,pad=.2&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;d) Sparse cloud&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">.03</span><span class="p">,</span> <span class="mf">.96</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;$v_t$ (m$\,$s$^{-1}$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;$v_t$ (m$\,$s$^{-1}$)&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="plot_dynamic_rossby">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_dynamic_rossby">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_dynamic_rossby</span><span class="p">(</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">Ro</span><span class="p">,</span><span class="n">lonlims</span><span class="p">,</span><span class="n">latlims</span><span class="p">,</span><span class="n">Ro_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pdf_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">pscale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">LONr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">LATr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Ror</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">LONr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="n">bool_ref</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bool_ref</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="n">mn</span> <span class="o">=</span> <span class="mf">0.12</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="mf">.6</span>
    <span class="n">me</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="mf">.18</span>
    <span class="n">md</span> <span class="o">=</span> <span class="mf">.3</span>
    <span class="n">aspect_r</span> <span class="o">=</span> <span class="mf">1.5</span>

    <span class="n">Nx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">bool_ref</span>
    <span class="n">Ny</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">aspect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lonlims</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">latlims</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">lx</span> <span class="o">=</span> <span class="n">me</span><span class="o">+</span><span class="n">mw</span><span class="o">+</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">aspect_r</span><span class="o">/</span><span class="n">aspect</span><span class="o">+</span><span class="n">md</span>
    <span class="n">ly</span> <span class="o">=</span> <span class="n">mn</span><span class="o">+</span><span class="n">ms</span><span class="o">+</span><span class="n">Ny</span><span class="o">/</span><span class="n">aspect</span>

    <span class="n">ph</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">ly</span><span class="o">/</span><span class="n">aspect</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">lx</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">aspect_r</span><span class="o">/</span><span class="n">aspect</span><span class="o">/</span><span class="n">lx</span><span class="p">]</span>

    <span class="n">cbd</span> <span class="o">=</span> <span class="mf">.14</span> <span class="o">*</span><span class="n">ly</span><span class="o">/</span><span class="n">lx</span>
    <span class="n">cbr</span> <span class="o">=</span> <span class="mf">.85</span>
    <span class="n">cbw</span> <span class="o">=</span> <span class="mf">.04</span> <span class="o">*</span><span class="n">ly</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">px_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">mw</span><span class="o">/</span><span class="n">lx</span><span class="p">]</span><span class="o">+</span><span class="n">bool_ref</span><span class="o">*</span><span class="p">[(</span><span class="n">mw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">lx</span><span class="p">]</span><span class="o">+</span><span class="p">[(</span><span class="n">mw</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">bool_ref</span><span class="o">+</span><span class="n">md</span><span class="p">)</span><span class="o">/</span><span class="n">lx</span><span class="p">]</span>
    <span class="n">py_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ms</span><span class="o">/</span><span class="n">ly</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">bool_ref</span><span class="p">:</span>
        <span class="n">fw</span><span class="o">=</span><span class="mi">10</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fw</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">fw</span><span class="o">*</span><span class="n">ly</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">],</span><span class="nb">object</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fw</span><span class="p">,</span><span class="n">fh</span><span class="p">))</span>

    <span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">cmapRo</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span>
    <span class="k">if</span> <span class="n">Ro_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bool_ref</span><span class="p">:</span>
            <span class="n">Roval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">Ro</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">Ror</span><span class="o">.</span><span class="n">flatten</span><span class="p">()])</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">Roval</span> <span class="o">=</span> <span class="n">Ro</span>
        <span class="n">Ro_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Roval</span><span class="p">))</span>
    <span class="n">plimRo</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">Ro_max</span><span class="p">,</span><span class="n">Ro_max</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">px_range</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">py_range</span><span class="p">[</span><span class="n">jj</span><span class="p">],</span> <span class="n">pw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ph</span><span class="p">])</span>  <span class="c1"># [left, bottom, width, height]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">lonlims</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">jj</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">latlims</span><span class="p">)</span>

    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">Ro</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapRo</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimRo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimRo</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">plimRo</span><span class="p">,</span><span class="n">cmapRo</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\textrm</span><span class="si">{Ro}</span><span class="s1">_t$&#39;</span><span class="p">)</span> 

    <span class="k">if</span> <span class="n">u</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">LON</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">l_unit</span><span class="o">=</span><span class="s1">&#39;m$\,$s$^{-1}$&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">bool_ref</span><span class="p">:</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Altimetry&#39;</span><span class="p">)</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">LONr</span><span class="p">,</span><span class="n">LATr</span><span class="p">,</span><span class="n">Ror</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmapRo</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">plimRo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">plimRo</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
    
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">bin_step</span> <span class="o">=</span> <span class="mf">.04</span>
    <span class="n">range_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">bin_step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">Ro_max</span><span class="p">,</span><span class="n">bin_step</span><span class="p">)</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">range_pos</span><span class="p">),</span><span class="n">range_pos</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">bool_ref</span><span class="p">:</span>
        <span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">Ro</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">drawstyle</span><span class="o">=</span><span class="s1">&#39;steps-post&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span>
        <span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">Ror</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">drawstyle</span><span class="o">=</span><span class="s1">&#39;steps-post&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Altimetry&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">Ro</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\textrm</span><span class="si">{Ro}</span><span class="s1">_t$&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Empirical density&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pdf_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">pdf_max</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">])</span>

    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">axi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ticks_in_deg</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="n">annotate_corner</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="k">if</span> <span class="n">bool_ref</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        
        

    <span class="n">ax0</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

 
<div class="viewcode-block" id="plot_particle_tracking">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_particle_tracking">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_particle_tracking</span><span class="p">(</span><span class="n">list_dict_tracks</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">muustar</span><span class="p">,</span><span class="n">muvstar</span><span class="p">,</span><span class="n">Kxstar_vel</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">lonlimsp</span><span class="p">,</span><span class="n">latlimsp</span><span class="p">,</span><span class="n">pscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>   

    <span class="n">LON</span><span class="p">,</span> <span class="n">LAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">)</span>



    <span class="n">crop_lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon</span> <span class="o">&gt;=</span> <span class="n">lonlimsp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lon</span> <span class="o">&lt;=</span> <span class="n">lonlimsp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">crop_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat</span> <span class="o">&gt;=</span> <span class="n">latlimsp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lat</span> <span class="o">&lt;=</span> <span class="n">latlimsp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">LONc</span> <span class="o">=</span> <span class="n">LON</span><span class="p">[</span><span class="n">crop_lat</span><span class="p">,:][:,</span><span class="n">crop_lon</span><span class="p">]</span>
    <span class="n">LATc</span> <span class="o">=</span> <span class="n">LAT</span><span class="p">[</span><span class="n">crop_lat</span><span class="p">,:][:,</span><span class="n">crop_lon</span><span class="p">]</span>
    <span class="n">Tc</span><span class="o">=</span><span class="n">T</span><span class="p">[</span><span class="n">crop_lat</span><span class="p">,:][:,</span><span class="n">crop_lon</span><span class="p">]</span>
    <span class="n">muustarc</span><span class="o">=</span><span class="n">muustar</span><span class="p">[</span><span class="n">crop_lat</span><span class="p">,:][:,</span><span class="n">crop_lon</span><span class="p">]</span>
    <span class="n">muvstarc</span><span class="o">=</span><span class="n">muvstar</span><span class="p">[</span><span class="n">crop_lat</span><span class="p">,:][:,</span><span class="n">crop_lon</span><span class="p">]</span>
    <span class="n">Kxstar_velc</span><span class="o">=</span><span class="n">Kxstar_vel</span><span class="p">[</span><span class="n">crop_lat</span><span class="p">,:,:,:][:,</span><span class="n">crop_lon</span><span class="p">,:,:]</span>


    <span class="n">mn</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="mf">.25</span>
    <span class="n">me</span> <span class="o">=</span> <span class="mf">.05</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="mf">.1</span>
    
    <span class="n">Nx</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">Ny</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">aspect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lonlimsp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">latlimsp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">lx</span> <span class="o">=</span> <span class="n">me</span><span class="o">+</span><span class="n">mw</span><span class="o">+</span><span class="n">Nx</span>
    <span class="n">ly</span> <span class="o">=</span> <span class="n">mn</span><span class="o">+</span><span class="n">ms</span><span class="o">+</span><span class="n">Ny</span><span class="o">/</span><span class="n">aspect</span>

    <span class="n">ph</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">ly</span><span class="o">/</span><span class="n">aspect</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">cbd</span> <span class="o">=</span> <span class="mf">.01</span> <span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">cbr</span> <span class="o">=</span> <span class="mf">.85</span>
    <span class="n">cbw</span> <span class="o">=</span> <span class="mf">.02</span> <span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>

    <span class="n">px_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">mw</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Nx</span><span class="p">))</span><span class="o">/</span><span class="n">lx</span>
    <span class="n">py_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ms</span><span class="o">/</span><span class="n">ly</span><span class="p">])</span>

    <span class="n">fw</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">fw</span><span class="o">*</span><span class="n">ly</span><span class="o">/</span><span class="n">lx</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">],</span><span class="nb">object</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fw</span><span class="p">,</span><span class="n">fh</span><span class="p">))</span>

    <span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">cmapT</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">lighten</span><span class="p">(</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">thermal</span><span class="p">,</span><span class="mf">.8</span><span class="p">)</span>
    <span class="n">plimT</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Tc</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Tc</span><span class="p">)]</span>

    <span class="n">add_colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">plimT</span><span class="p">,</span><span class="n">cmapT</span><span class="p">,</span><span class="n">cbr</span><span class="p">,</span><span class="n">cbd</span><span class="p">,</span><span class="n">cbw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;($^\circ$C)&#39;</span><span class="p">)</span> 
    
    <span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">latlimsp</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">lonlimsp</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="n">pscale_cred</span> <span class="o">=</span> <span class="n">pscale</span>

    <span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">LONc</span><span class="p">,</span><span class="n">LATc</span><span class="p">,</span><span class="n">Tc</span><span class="p">,</span><span class="n">cmapT</span><span class="p">)</span>

    <span class="n">draw_confidence_ellipse</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">LONc</span><span class="p">,</span><span class="n">LATc</span><span class="p">,</span><span class="n">Kxstar_velc</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale_cred</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dict_tracks</span> <span class="ow">in</span> <span class="n">list_dict_tracks</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
            <span class="n">n_sample</span> <span class="o">=</span> <span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;lons&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sample</span><span class="p">):</span>
                <span class="n">axi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;lons&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,:],</span><span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;lats&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">,:],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;lonsm&quot;</span><span class="p">],</span><span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;latsm&quot;</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">axi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;lon0&quot;</span><span class="p">],</span><span class="n">dict_tracks</span><span class="p">[</span><span class="s2">&quot;lat0&quot;</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>


    <span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">LONc</span><span class="p">,</span><span class="n">LATc</span><span class="p">,</span><span class="n">muustarc</span><span class="p">,</span><span class="n">muvstarc</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">pscale</span><span class="p">,</span><span class="n">an</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>


    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">ticks_in_deg</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.2</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="n">annotate_corner</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">j</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

    <span class="n">mw</span> <span class="o">=</span> <span class="n">px_range</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="n">py_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ldx</span> <span class="o">=</span> <span class="mf">.02</span>
    <span class="n">ldy</span> <span class="o">=</span> <span class="n">ph</span><span class="o">+</span><span class="mf">.015</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">lh</span> <span class="o">=</span> <span class="mf">.015</span><span class="o">*</span><span class="n">lx</span><span class="o">/</span><span class="n">ly</span>
    <span class="n">lw</span> <span class="o">=</span> <span class="mf">.005</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 SD Credible Ellipse&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="p">(</span><span class="n">pscale_cred</span><span class="p">)</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;|-|,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale_cred</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">mw</span> <span class="o">=</span> <span class="n">px_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="n">py_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">lh</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;Velocity&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;&lt;|-,widthA=0.35,widthB=0.35&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">))</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mw</span><span class="o">+</span><span class="n">pw</span><span class="o">/</span><span class="n">pscale</span><span class="o">+</span><span class="n">lw</span><span class="o">+</span><span class="n">ldx</span><span class="p">,</span><span class="n">ms</span><span class="o">+</span><span class="n">ldy</span><span class="p">,</span><span class="s1">&#39;1 m$\,$s$^{-1}$&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">ax0</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

 

<div class="viewcode-block" id="plot_noise_metrics">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_noise_metrics">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_noise_metrics</span><span class="p">(</span>
    <span class="n">df_noise_gp_obs_t</span><span class="p">,</span>
    <span class="n">df_noise_gp_num_t</span><span class="p">,</span>
    <span class="n">df_noise_gos_t</span><span class="p">,</span>
    <span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_noise_gos_t</span><span class="o">.</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">df_noise_gos_t</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;rs&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GOS&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_noise_gp_num_t</span><span class="o">.</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">df_noise_gp_num_t</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_</span><span class="si">{t}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_noise_gp_obs_t</span><span class="o">.</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">df_noise_gp_obs_t</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">hat{</span><span class="se">\\</span><span class="s1">theta}_t$&#39;</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sigma_</span><span class="se">\\</span><span class="s1">tau$ (K)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;RMSE (m$\,$s$^{-1}$)&#39;</span><span class="p">)</span>
    <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.25</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_noise_gp_num_t</span><span class="o">.</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">df_noise_gp_num_t</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_</span><span class="si">{t}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_noise_gp_obs_t</span><span class="o">.</span><span class="n">noise_sd</span><span class="p">,</span><span class="n">df_noise_gp_obs_t</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">hat{</span><span class="se">\\</span><span class="s1">theta}_t$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">sigma_</span><span class="se">\\</span><span class="s1">tau$ (K)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;P90&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.25</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">axi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>

        <span class="n">annotate_corner</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span><span class="n">box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">buffer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="plot_time_metrics">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_time_metrics">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_time_metrics</span><span class="p">(</span>
    <span class="n">df_time_1h_gp_obs_t</span><span class="p">,</span>
    <span class="n">df_time_1h_gp_num_t</span><span class="p">,</span>
    <span class="n">df_time_1h_gp_num_t1</span><span class="p">,</span>
    <span class="n">df_time_1h_gos_t</span><span class="p">,</span>
    <span class="n">df_time_24h_gp_obs_t</span><span class="p">,</span>
    <span class="n">df_time_24h_gp_num_t</span><span class="p">,</span>
    <span class="n">df_time_24h_gp_num_t1</span><span class="p">,</span>
    <span class="n">df_time_24h_gos_t</span><span class="p">,</span>
    <span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



    <span class="n">dict_time_1h</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gprm&#39;</span><span class="p">:</span> <span class="n">df_time_1h_gp_num_t</span><span class="p">,</span>
            <span class="s1">&#39;gprm_e&#39;</span><span class="p">:</span> <span class="n">df_time_1h_gp_num_t1</span><span class="p">,</span>
            <span class="s1">&#39;gos&#39;</span><span class="p">:</span> <span class="n">df_time_1h_gos_t</span><span class="p">,</span>
            <span class="s1">&#39;optimum&#39;</span><span class="p">:</span> <span class="n">df_time_1h_gp_obs_t</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="n">dict_time_24h</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gprm&#39;</span><span class="p">:</span> <span class="n">df_time_24h_gp_num_t</span><span class="p">,</span>
            <span class="s1">&#39;gprm_e&#39;</span><span class="p">:</span> <span class="n">df_time_24h_gp_num_t1</span><span class="p">,</span>
            <span class="s1">&#39;gos&#39;</span><span class="p">:</span> <span class="n">df_time_24h_gos_t</span><span class="p">,</span>
            <span class="s1">&#39;optimum&#39;</span><span class="p">:</span> <span class="n">df_time_24h_gp_obs_t</span><span class="p">,</span>
        <span class="p">}</span>
    
    <span class="n">type_test_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time_1h&#39;</span><span class="p">,</span><span class="s1">&#39;time_24h&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">type_test</span> <span class="ow">in</span> <span class="n">type_test_list</span><span class="p">:</span>

        <span class="c1"># make figure</span>
        <span class="k">if</span> <span class="n">type_test</span><span class="o">==</span><span class="s1">&#39;time_1h&#39;</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;$t$ (h)&#39;</span>
            <span class="n">xscale</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3600</span>
            <span class="n">dict_time</span> <span class="o">=</span> <span class="n">dict_time_1h</span>
        <span class="k">elif</span> <span class="n">type_test</span><span class="o">==</span><span class="s1">&#39;time_24h&#39;</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;$t$ (d)&#39;</span>
            <span class="n">xscale</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3600</span><span class="o">/</span><span class="mi">24</span>
            <span class="n">dict_time</span> <span class="o">=</span> <span class="n">dict_time_24h</span>

        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GOS&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_</span><span class="si">{t_1}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">hat{</span><span class="se">\\</span><span class="s1">theta}_t&#39;</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;optimum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;optimum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_t$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;RMSE (m$\,$s$^{-1}$)&#39;</span><span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.25</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_</span><span class="si">{t_1}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">hat{</span><span class="se">\\</span><span class="s1">theta}_t&#39;</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;optimum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time_sec</span><span class="o">*</span><span class="n">xscale</span><span class="p">,</span><span class="n">dict_time</span><span class="p">[</span><span class="s2">&quot;optimum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_t$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;P90&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.25</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_test_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ylim00</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ylim10</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ylims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ylim00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylim10</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">max</span><span class="p">(</span><span class="n">ylim00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ylim10</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
        

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">axi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>

        <span class="n">annotate_corner</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span><span class="n">box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">buffer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="plot_cloud_metrics">
<a class="viewcode-back" href="../../api.html#inversion_sst_gp.plot_helper.plot_cloud_metrics">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_cloud_metrics</span><span class="p">(</span>
    <span class="n">df_cloud_dense_gp_num_t</span><span class="p">,</span>
    <span class="n">df_cloud_dense_gp_obs_t</span><span class="p">,</span>
    <span class="n">df_cloud_sparse_gp_num_t</span><span class="p">,</span>
    <span class="n">df_cloud_sparse_gp_obs_t</span><span class="p">,</span>
    <span class="n">plt_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



    <span class="n">dict_cloud_sparse</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gprm&#39;</span><span class="p">:</span> <span class="n">df_cloud_sparse_gp_num_t</span><span class="p">,</span>
            <span class="s1">&#39;gprm_e&#39;</span><span class="p">:</span> <span class="n">df_cloud_sparse_gp_obs_t</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="n">dict_cloud_dense</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gprm&#39;</span><span class="p">:</span> <span class="n">df_cloud_dense_gp_num_t</span><span class="p">,</span>
            <span class="s1">&#39;gprm_e&#39;</span><span class="p">:</span> <span class="n">df_cloud_dense_gp_obs_t</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="n">type_test_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cloud_dense&#39;</span><span class="p">,</span><span class="s1">&#39;cloud_sparse&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">type_test</span> <span class="ow">in</span> <span class="n">type_test_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">type_test</span><span class="o">==</span><span class="s1">&#39;cloud_sparse&#39;</span><span class="p">):</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;sparse cloud coverage ($\%$)&#39;</span>
            <span class="n">dict_cloud</span> <span class="o">=</span> <span class="n">dict_cloud_sparse</span>
            <span class="n">val_name</span> <span class="o">=</span> <span class="s1">&#39;coverage_sparse&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">type_test</span><span class="o">==</span><span class="s1">&#39;cloud_dense&#39;</span><span class="p">):</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;dense cloud coverage ($\%$)&#39;</span>
            <span class="n">dict_cloud</span> <span class="o">=</span> <span class="n">dict_cloud_dense</span>
            <span class="n">val_name</span> <span class="o">=</span> <span class="s1">&#39;coverage_dense&#39;</span>

        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">][</span><span class="n">val_name</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_</span><span class="si">{t_1}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">][</span><span class="n">val_name</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">RMSE</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">hat{</span><span class="se">\\</span><span class="s1">theta}_t&#39;</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;RMSE (m$\,$s$^{-1}$)&#39;</span><span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.25</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">][</span><span class="n">val_name</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">tilde{</span><span class="se">\\</span><span class="s1">theta}_</span><span class="si">{t_1}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">][</span><span class="n">val_name</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">dict_cloud</span><span class="p">[</span><span class="s2">&quot;gprm_e&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coverage90</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GP $</span><span class="se">\\</span><span class="s1">hat{</span><span class="se">\\</span><span class="s1">theta}_t&#39;</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;P90&#39;</span><span class="p">)</span>
       
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ylims</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">.25</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_test_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ylim00</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ylim10</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ylims</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">ylim00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ylim10</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">max</span><span class="p">(</span><span class="n">ylim00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ylim10</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
        

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">axi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">axi</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>

        <span class="n">annotate_corner</span><span class="p">(</span><span class="n">axi</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">97</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span><span class="n">box</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">buffer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">plt_show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">SST currents</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html#simulation">Simulation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Rick de Kreij.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.0.4</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>